# VMC Chat - PRD (Product Requirements Document)

## 제품 개요
**제품명**: VMC Chat  
**목적**: 실시간 메시지 송수신이 가능한 웹 기반 채팅 서비스  
**핵심 가치**: 누구나 채팅방을 만들고 참여할 수 있으며, 답장·좋아요 등 소셜 기능 제공  
**기술 스택**: Supabase Auth (인증), Supabase Database (데이터 저장), Polling (메시지 동기화)

---

## Stakeholders
- **Product Owner**: 제품 기획 및 우선순위 결정
- **개발팀**: 프론트엔드/백엔드 개발 및 Supabase 연동
- **디자이너**: UI/UX 설계
- **최종 사용자**: 채팅방 생성자 및 참여자

---

## 포함 페이지

| 페이지명 | 경로 예시 | 접근 권한 |
|---------|----------|----------|
| 회원가입 페이지 | `/signup` | 비로그인 |
| 로그인 페이지 | `/login` | 비로그인 |
| 채팅방 목록 페이지 (홈) | `/` | 모두 |
| 채팅방 생성 페이지 | `/create-room` | 로그인 필수 |
| 채팅방 페이지 | `/room/:roomId` | 모두 (메시지 전송은 로그인 필요) |
| 마이페이지 | `/mypage` | 로그인 필수 |

---

## 데이터 요구사항

### 사용자 데이터
- 사용자 인증 정보 (Supabase Auth)
- 프로필: 이메일, 닉네임, 가입일

### 채팅방 데이터
- 채팅방 이름 (최대 100자)
- 생성자 정보
- 생성일시
- 최종 수정일시

### 메시지 데이터
- 메시지 내용
- 발신자 정보
- 소속 채팅방
- 전송 시간
- 답장 대상 메시지 (선택적)

### 좋아요 데이터
- 좋아요를 누른 메시지
- 좋아요를 누른 사용자
- 좋아요 생성일시
- 동일 사용자의 동일 메시지 중복 좋아요 방지

---

## 사용자 여정

### Segment 1: 비로그인 사용자 (Guest)
**목표**: 채팅방 탐색 및 서비스 체험

1. **채팅방 목록 페이지** (`/`) 진입
2. 채팅방 목록 확인 (읽기 전용)
3. 채팅방 카드 클릭 → **채팅방 페이지** (`/room/:roomId`) 이동
4. 메시지 읽기 (좋아요/답장/전송 불가)
5. 메시지 입력 영역 클릭 시 → **로그인 페이지** (`/login`)로 리다이렉트

---

### Segment 2: 신규 사용자 (New User)
**목표**: 회원가입 후 채팅 참여

1. **회원가입 페이지** (`/signup`) 진입
2. 이메일/비밀번호 입력 → Supabase Auth 회원가입
3. **로그인 페이지** (`/login`) → 로그인
4. **채팅방 목록 페이지** (`/`)로 자동 이동
5. 기존 채팅방 클릭 → **채팅방 페이지** (`/room/:roomId`) 진입
6. 메시지 전송, 좋아요, 답장 기능 사용

---

### Segment 3: 채팅방 생성자 (Room Creator)
**목표**: 새 채팅방 개설 및 관리

1. **채팅방 목록 페이지** (`/`)에서 '채팅방 추가하기' 버튼 클릭
2. **채팅방 생성 페이지** (`/create-room`) 진입
3. 채팅방 이름 입력 (최대 100자) → '추가' 버튼 클릭
4. 새 채팅방 생성 → **채팅방 페이지** (`/room/:newRoomId`) 자동 이동
5. 첫 메시지 전송
6. Polling으로 다른 사용자 메시지 확인

---

### Segment 4: 활성 사용자 (Active User)
**목표**: 프로필 관리 및 다양한 채팅방 참여

1. **채팅방 목록 페이지** (`/`)에서 '마이페이지' 버튼 클릭
2. **마이페이지** (`/mypage`) 진입
3. 닉네임 변경 → '변경 사항 저장' 클릭
4. **채팅방 목록 페이지** (`/`)로 복귀
5. 여러 채팅방 탐색 및 메시지 전송
6. 메시지에 좋아요/답장 기능 활용
7. 본인 메시지 삭제 기능 사용

---

## IA (Information Architecture)

```
VMC Chat
│
├─ 인증 (Authentication)
│  ├─ 회원가입 (/signup)
│  └─ 로그인 (/login)
│
├─ 채팅방 목록 (/) [홈]
│  │
│  ├─ 채팅방 생성 (/create-room) [로그인 필수]
│  │
│  └─ 채팅방 상세 (/room/:roomId)
│     ├─ 메시지 읽기 [모두]
│     ├─ 메시지 전송 [로그인 필수]
│     ├─ 좋아요 토글 [로그인 필수]
│     ├─ 답장 [로그인 필수]
│     └─ 메시지 삭제 [작성자만]
│
└─ 마이페이지 (/mypage) [로그인 필수]
   ├─ 프로필 조회
   ├─ 닉네임 변경
   └─ 로그아웃
```

---

## 핵심 기능 요약

### 인증 및 권한
- **Public**: 채팅방 목록 조회, 채팅방 메시지 읽기
- **Authenticated**: 채팅방 생성, 메시지 전송, 좋아요, 답장, 본인 메시지 삭제, 프로필 관리

### Polling 메커니즘
- **채팅방 페이지**: 3-5초 간격으로 새 메시지 조회
- **채팅방 목록 페이지**: 10초 간격으로 채팅방 목록 갱신
- 메시지 전송 시 즉시 polling 실행하여 화면 갱신

### 소셜 기능
- **좋아요**: 메시지별 좋아요 수 표시 및 토글 (중복 방지)
- **답장**: 특정 메시지에 답장 연결, 답장 대상 메시지 정보 함께 표시
- **삭제**: 본인 메시지만 삭제 가능

### UI/UX 규칙
- 본인 메시지: 오른쪽 정렬
- 타인 메시지: 왼쪽 정렬
- 답장 모드: 입력창 상단에 답장 대상 표시 + 취소(X) 버튼
- 비로그인 시 메시지 입력 시도 → 로그인 페이지 리다이렉트
- 메시지 전송 후 입력창 초기화
- 채팅방 최종 수정일 자동 갱신

---

## 페이지별 요구사항

### 1. 회원가입 페이지
- Supabase Auth 이메일/비밀번호 회원가입
- 회원가입 성공 시 프로필 데이터 생성 (초기 닉네임은 이메일 기반)

### 2. 로그인 페이지
- Supabase Auth 이메일/비밀번호 로그인
- 로그인 성공 시 채팅방 목록 페이지로 이동

### 3. 채팅방 목록 페이지
- 모든 채팅방을 최신 수정일순으로 조회
- 각 카드: 채팅방 이름, 생성자 닉네임, 최종 수정 시간
- 로그인 사용자: 이메일, 마이페이지 버튼, 로그아웃 버튼, 채팅방 추가 버튼 표시
- 비로그인 사용자: 로그인 버튼만 표시
- 10초 간격 polling으로 목록 갱신

### 4. 채팅방 생성 페이지
- 로그인 필수 (비로그인 시 로그인 페이지 리다이렉트)
- 채팅방 이름 입력 (최대 100자)
- 추가 버튼: 채팅방 생성 후 해당 채팅방 페이지로 이동
- 취소 버튼: 채팅방 목록으로 복귀

### 5. 채팅방 페이지
- 채팅방 제목 표시
- 메시지 시간순 정렬 표시
- 각 메시지: 발신자 닉네임, 내용, 전송 시간, 좋아요 수
- 답장 메시지: 답장 대상 정보 함께 표시
- 본인/타인 메시지 좌우 정렬
- 로그인 사용자: 좋아요/답장/삭제(본인만) 버튼 표시
- 3-5초 간격 polling으로 새 메시지 조회
- 메시지 전송 시 채팅방 최종 수정일 갱신
- 비로그인 사용자가 입력창 클릭 시 로그인 페이지 이동

### 6. 마이페이지
- 로그인 필수 (비로그인 시 로그인 페이지 리다이렉트)
- 이메일, 현재 닉네임, 가입일 표시
- 닉네임 변경 입력창 및 저장 버튼
- 로그아웃 버튼: 로그아웃 후 로그인 페이지 이동

---